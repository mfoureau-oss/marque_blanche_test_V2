<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estimation BMW</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: white;
            min-height: 100vh;
        }

        /* Hero Section */
        .hero {
            background: white;
            padding: 100px 20px 60px 20px;
            border-bottom: 1px solid #E9EDF5;
            position: relative;
        }

        .burger {
            position: absolute;
            top: 24px;
            left: 24px;
            width: 24px;
            height: 20px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .burger span {
            width: 24px;
            height: 2px;
            background: #0E0E11;
            display: block;
        }

        .hero-content {
            max-width: 1140px;
            margin: 0 auto;
            text-align: center;
        }

        .logo {
            width: 88px;
            height: 88px;
            margin: 0 auto 28px auto;
            border-radius: 50%;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 8px;
            background: white;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        h1 {
            font-size: clamp(32px, 4vw, 48px);
            font-weight: 800;
            color: #0E0E11;
            margin-bottom: 14px;
        }

        .subtitle {
            font-size: 19px;
            color: #3A3F4B;
            line-height: 1.5;
        }

        /* Options Section */
        .options {
            background: linear-gradient(135deg, #E8E6F7 0%, #F3F2FA 100%);
            padding: 80px 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
        }

        .options-container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .options h2 {
            font-size: 48px;
            font-weight: 600;
            color: #1a1a1a;
            text-align: center;
            margin-bottom: 70px;
        }

        .cards-wrapper {
            display: flex;
            gap: 40px;
            align-items: center;
            justify-content: center;
        }

        .card {
            background: #FFFEF5;
            border: 2px solid #E5E5E5;
            border-radius: 24px;
            padding: 50px 40px;
            width: 100%;
            max-width: 580px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .card:hover {
            background: #F8F6ED;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .card.selected {
            border-color: #4A3AFF;
        }

        .badge {
            background: #4A3AFF;
            color: white;
            padding: 10px 24px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-bottom: 40px;
            text-transform: uppercase;
            display: inline-block;
        }

        .card h3 {
            font-size: 32px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 30px;
        }

        .card p {
            font-size: 18px;
            color: #666;
            line-height: 1.5;
            margin-bottom: 50px;
            max-width: 380px;
            margin-left: auto;
            margin-right: auto;
        }

        .features {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
            font-weight: 500;
            color: #4A3AFF;
        }

        .feature::before {
            content: '✓';
            font-weight: bold;
        }

        .divider {
            font-size: 36px;
            font-weight: 600;
            color: #1a1a1a;
            padding: 0 20px;
        }

        /* Section cachée par défaut */
        .progressive-section {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease-out;
        }

        .progressive-section.revealed {
            display: block;
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Recherche Immatriculation Section */
        .main-section {
            background: #FAFBFD;
            border-radius: 24px;
            padding: 80px 20px;
            margin: 0 20px;
        }

        .container {
            max-width: 1140px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
        }

        .page-title {
            font-size: 42px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 12px;
        }

        .page-subtitle {
            font-size: 18px;
            color: #666;
            font-weight: 400;
        }

        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
            align-items: start;
        }

        .left-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .search-row {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .input-wrapper {
            position: relative;
            flex: 1;
        }

        .immatriculation-input {
            width: 100%;
            height: 56px;
            padding: 0 55px 0 24px;
            font-size: 18px;
            font-weight: 500;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            border: 2px solid #E0E0E0;
            border-radius: 28px;
            background: white;
            color: #999;
            outline: none;
            transition: all 0.3s ease;
        }

        .immatriculation-input:focus {
            border-color: #4A40FF;
        }

        .input-check {
            display: none !important;
        }

        .input-check.active {
            display: flex;
        }

        .input-check::after {
            content: '✓';
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        .search-button {
            height: 56px;
            padding: 0 32px;
            background: #4A40FF;
            color: white;
            border: none;
            border-radius: 28px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            white-space: nowrap;
            position: relative;
        }

        .search-button:hover {
            background: #3A30EF;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74, 64, 255, 0.25);
        }

        .search-icon-wrapper {
            width: 32px;
            height: 32px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .search-icon-wrapper svg {
            width: 16px;
            height: 16px;
        }

        .format-info {
            background: #F0F0F0;
            border-radius: 16px;
            padding: 20px 24px;
        }

        .format-title {
            font-size: 15px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }

        .format-text {
            font-size: 14px;
            color: #666;
        }

        .result-card {
            background: #EBF4FF;
            border: 2px solid #4F46E5;
            border-radius: 20px;
            padding: 32px;
        }

        /* Caractéristiques Section */
        .caracteristiques-section {
            background: #F8F9FC;
            border-radius: 32px;
            padding: 80px 20px;
            margin: 0 20px;
        }

        .section-title {
            font-size: 42px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 12px;
        }

        .section-subtitle {
            font-size: 18px;
            color: #666;
            font-weight: 400;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .field-card {
            position: relative;
            background: #F0F2F5;
            border: 1.5px solid #D5D8E0;
            border-radius: 16px;
            padding: 14px 24px;
            height: 70px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .field-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-color: #B8BCC8;
        }

        .field-card.selected {
            background: #EBF4FF;
            border-color: #4F46E5;
            /* Removed extra padding, using cleaner validation approach */
        }

        .field-label {
            font-size: 10px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
            line-height: 1;
        }

        .field-value {
            font-size: 16px;
            color: #333;
            font-weight: 500;
            line-height: 1.2;
        }

        .field-value.placeholder {
            color: #999;
        }

        .native-select {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
            z-index: 1;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            border: none;
            background: none;
        }

        .chevron {
            width: 24px;
            height: 24px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            transition: all 0.3s ease;
            /* Added flex properties to ensure perfect centering */
            flex-shrink: 0;
        }

        .chevron::after {
            content: '›';
            color: #666;
            font-size: 18px;
            font-weight: 600;
            /* Added line-height for better vertical alignment */
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* New validation approach - replace chevron with check when validated */
        .field-card.selected .chevron {
            background: #4F46E5;
        }

        .field-card.selected .chevron::after {
            content: '✓';
            color: white;
            font-size: 14px;
            font-weight: bold;
            /* Ensured consistent alignment for checkmark */
            line-height: 1;
        }

        /* Remove old validation-check class - no longer needed */
        .validation-check {
            display: none;
        }

        .separator {
            height: 1px;
            background: #E0E0E0;
            margin: 0 0 20px 0;
        }

        .footer-info {
            font-size: 14px;
            color: #666;
        }

        /* État général Section */
        .cards-row {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 60px;
            flex-wrap: nowrap;
        }

        .state-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            padding: 35px 20px;
            width: 200px;
            height: 180px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            text-align: center;
            flex-shrink: 0;
        }

        .state-card:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }

        .state-card.selected {
            border-color: #2D2DFF;
        }

        .star-icon {
            width: 44px;
            height: 44px;
            margin-bottom: 16px;
            stroke: #1a1a1a;
            stroke-width: 2;
            fill: none;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .card-subtitle {
            font-size: 14px;
            color: #999;
            line-height: 1.3;
        }

        .explanation-zone {
            text-align: center;
        }

        .selected-state-title {
            font-size: 28px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 12px;
        }

        .selected-state-description {
            font-size: 16px;
            color: #666;
            margin-bottom: 24px;
        }

        .impact-chip {
            display: inline-block;
            background: #D6DCFF;
            color: #2D2DFF;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 15px;
            font-weight: 600;
        }

        /* Options Section */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        @media (min-width: 768px) {
            .options-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .options-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .option-card {
            position: relative;
            background: white;
            border-radius: 0.75rem;
            border: 2px solid #e5e7eb;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .option-card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-color: #d1d5db;
        }

        .option-card.selected {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .category-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .checkbox {
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            border: 2px solid #d1d5db;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .checkbox.checked {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }

        .option-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: #111827;
        }

        .info-section {
            background-color: #eff6ff;
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid #bfdbfe;
        }

        /* Contact Section */
        .summary-block {
            background: #F0F2F5;
            border: 1.5px solid #D5D8E0;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 40px;
            display: flex;
            align-items: center;
            gap: 24px;
            transition: all 0.3s ease;
        }

        .summary-block:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-color: #B8BCC8;
        }

        .summary-icon {
            width: 48px;
            height: 48px;
            background: #E8F4FD;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .summary-icon svg {
            width: 24px;
            height: 24px;
            color: #2563EB;
        }

        .summary-content {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .summary-main {
            flex: 1;
        }

        .summary-label {
            font-size: 10px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .summary-price {
            font-size: 32px;
            font-weight: 700;
            color: #1a1a1a;
            line-height: 1;
        }

        .summary-divider {
            width: 1px;
            height: 40px;
            background: #D5D8E0;
            flex-shrink: 0;
        }

        .summary-secondary {
            text-align: right;
            position: relative;
        }

        .summary-secondary-label {
            font-size: 10px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .summary-secondary-text {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        .steps-accent {
            position: absolute;
            left: -12px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: #F59E0B;
            border-radius: 2px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .field-card {
            position: relative;
            background: #F0F2F5;
            border: 1.5px solid #D5D8E0;
            border-radius: 16px;
            padding: 14px 24px;
            height: 70px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .field-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-color: #B8BCC8;
        }

        .field-card:focus-within {
            outline: 2px solid #4A40FF;
            outline-offset: 2px;
        }

        .field-card.selected {
            background: #EBF4FF;
            border-color: #4F46E5;
            /* Removed extra padding for cleaner look */
        }

        .field-label {
            font-size: 10px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
            line-height: 1;
        }

        .field-value {
            font-size: 16px;
            color: #333;
            font-weight: 500;
            line-height: 1.2;
        }

        .field-value.placeholder {
            color: #999;
        }

        .field-input {
            background: transparent;
            border: none;
            font-size: 16px;
            color: #333;
            font-weight: 500;
            outline: none;
            width: 100%;
            position: relative;
            z-index: 2;
        }

        .field-input::placeholder {
            color: #999;
        }

        .native-select {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
            z-index: 1;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            border: none;
            background: none;
        }

        .chevron {
            width: 24px;
            height: 24px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            transition: all 0.3s ease;
            /* Added flex properties to ensure perfect centering */
            flex-shrink: 0;
        }

        .chevron::after {
            content: '›';
            color: #666;
            font-size: 18px;
            font-weight: 600;
            /* Added line-height for better vertical alignment */
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Updated validation styling to replace chevron with check */
        .field-card.selected .chevron {
            background: #4F46E5;
        }

        .field-card.selected .chevron::after {
            content: '✓';
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        /* Hide old validation check */
        .validation-check {
            display: none;
        }

        /* Updating contact preferences to match options style */
        .contact-preferences {
            margin-top: 40px;
        }

        .contact-preferences-title {
            font-size: 32px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 30px;
            text-align: center;
        }

        .contact-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        @media (min-width: 1024px) {
            .contact-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .contact-card {
            position: relative;
            background: white;
            border-radius: 0.75rem;
            border: 2px solid #e5e7eb;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-height: 120px;
        }

        .contact-card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-color: #d1d5db;
        }

        .contact-card.selected {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }

        .contact-icon {
            width: 48px;
            height: 48px;
            background: #eff6ff;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .contact-icon svg {
            width: 24px;
            height: 24px;
            color: #3b82f6;
        }

        .contact-card.selected .contact-icon {
            background: #3b82f6;
        }

        .contact-card.selected .contact-icon svg {
            color: white;
        }

        .contact-info {
            flex: 1;
        }

        .contact-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 0.25rem;
        }

        .contact-subtitle {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .contact-card.selected .contact-title {
            color: #3b82f6;
        }

        .contact-checkbox {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            border: 2px solid #d1d5db;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .contact-card.selected .contact-checkbox {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }

        .contact-checkbox::after {
            content: '✓';
            color: white;
            font-size: 12px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .contact-card.selected .contact-checkbox::after {
            opacity: 1;
        }

        .cta-section {
            margin-top: 50px;
            text-align: center;
            padding: 30px 0;
        }

        .cta-button {
            background: linear-gradient(135deg, #10C876 0%, #0EA968 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 48px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(16, 200, 118, 0.2);
            display: inline-block;
            text-decoration: none;
        }

        .cta-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(16, 200, 118, 0.3);
            background: linear-gradient(135deg, #0EA968 0%, #0D9B5F 100%);
        }

        .cta-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(16, 200, 118, 0.2);
        }

        .footer-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #E0E0E0;
            text-align: center;
        }

        .footer-info {
            font-size: 14px;
            color: #888;
            font-weight: 400;
        }

        @media (max-width: 640px) {
            .main-section {
                padding: 50px 20px;
            }

            .section-title {
                font-size: 32px;
            }

            .section-subtitle {
                font-size: 16px;
            }

            .form-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .summary-block {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .summary-content {
                width: 100%;
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .summary-divider {
                width: 100%;
                height: 1px;
            }

            .summary-secondary {
                text-align: left;
                width: 100%;
            }

            .summary-price {
                font-size: 28px;
            }

            .contact-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .contact-preferences-title {
                font-size: 24px;
            }

            .cta-button {
                width: 100%;
                max-width: 320px;
                padding: 16px 32px;
                font-size: 16px;
            }
            
            .cta-section {
                padding: 20px 0;
            }
        }

        @media (max-width: 768px) {
            .cards-row {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .state-card {
                width: calc(50% - 7.5px);
                min-width: 160px;
            }
        }

        @media (max-width: 480px) {
            .cards-row {
                flex-direction: column;
                align-items: center;
            }
            
            .state-card {
                width: 100%;
                max-width: 280px;
            }
        }

        /* Adding comprehensive mobile fixes to match user screenshots */
        
        /* Mobile fixes for Options section */
        @media (max-width: 768px) {
            .options {
                padding: 40px 15px;
                min-height: auto;
            }
            
            .options h2 {
                font-size: 28px;
                margin-bottom: 40px;
                line-height: 1.2;
            }
            
            .cards-wrapper {
                flex-direction: column;
                gap: 20px;
                align-items: stretch;
            }
            
            .card {
                max-width: none;
                padding: 30px 20px;
                margin: 0;
            }
            
            .card h3 {
                font-size: 24px;
                margin-bottom: 20px;
            }
            
            .card p {
                font-size: 16px;
                margin-bottom: 30px;
                max-width: none;
            }
            
            .features {
                gap: 20px;
                flex-direction: column;
                align-items: center;
            }
            
            .feature {
                font-size: 14px;
            }
            
            .divider {
                font-size: 24px;
                font-weight: 600;
                color: #1a1a1a;
                padding: 15px 0;
                background: white;
                border-radius: 20px;
                width: 80px;
                text-align: center;
                margin: 0 auto;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }
        }

        /* Mobile fixes for Immatriculation section */
        @media (max-width: 768px) {
            /* Making grid single column on mobile */
            .grid-container {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .search-row {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .input-wrapper {
                width: 100%;
            }
            
            .search-button {
                width: 100%;
                justify-content: center;
                padding: 0 20px;
                height: 56px;
            }
            
            .format-info {
                margin-top: 10px;
            }
            
            .result-card {
                margin-top: 0;
                order: 2;
            }
            
            /* Making result card single column on mobile */
            .result-card div[style*="grid-template-columns"] {
                display: grid !important;
                grid-template-columns: 1fr !important;
                gap: 12px !important;
            }
        }

        @media (max-width: 480px) {
            .options {
                padding: 30px 10px;
            }
            
            .options h2 {
                font-size: 24px;
                margin-bottom: 30px;
            }
            
            .card {
                padding: 25px 15px;
            }
            
            .card h3 {
                font-size: 20px;
            }
            
            .badge {
                font-size: 12px;
                padding: 8px 16px;
                margin-bottom: 20px;
            }
            
            .divider {
                font-size: 20px;
                width: 60px;
            }
        }

        /* Added styles for immatriculation validation and loading states */
        .immatriculation-input.error {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        .immatriculation-input.valid {
            border-color: #4F46E5 !important; /* Remplacé le vert par du bleu */
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); /* Remplacé le vert par du bleu */
        }

        .error-message {
            color: #ef4444;
            font-size: 12px;
            margin-top: 5px;
            font-weight: 500;
        }

        .search-button {
            transition: all 0.3s ease;
        }

        .search-button:disabled {
            background: #9ca3af !important;
            color: #6b7280 !important;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .search-button.active {
            background: #4A40FF !important;
            color: white !important;
            cursor: pointer;
        }

        .search-button.loading {
            opacity: 0.7;
            pointer-events: none;
        }

        /* Fixed spinner styles and removed problematic input-check */
        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .search-button.loading {
            opacity: 0.7;
            pointer-events: none;
        }

        /* Hide input-check to prevent green pin */
        .input-check {
            display: none !important;
        }

        .validate-button:hover {
            background: #3730a3 !important;
            transform: translateY(-1px);
            transition: all 0.2s ease;
        }

        .result-card.show {
            background: #EBF4FF;
            border-color: #4F46E5;
        }

        .option-card.selected .option-checkbox {
            background: #4F46E5;
            border-radius: 50%;
        }

        .contact-card.selected .contact-checkbox {
            background: #4F46E5;
            border-radius: 50%;
        }

        .cta-primary {
            background: linear-gradient(135deg, #4F46E5 0%, #3B82F6 100%);
            color: white;
        }

        .input-valid {
            border-color: #4F46E5 !important;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
    </style>
</head>
<body>
    <!-- Hero Section (gardé identique) -->
    <section class="hero">
        <div class="burger">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <div class="hero-content">
            <div class="logo">
                <img src="https://cdn.pixabay.com/photo/2016/08/15/18/18/bmw-1596080_1280.png" alt="BMW Logo">
            </div>
            <h1>Estimation de votre véhicule</h1>
            <p class="subtitle">Obtenez une estimation précise en quelques minutes</p>
        </div>
    </section>

    <!-- Options Section (gardé identique) -->
    <section class="options">
        <div class="options-container">
            <h2>Comment souhaitez-vous procéder ?</h2>
            
            <div class="cards-wrapper">
                <div class="card" onclick="showImmatriculation()">
                    <span class="badge">2 MINUTES CHRONO</span>
                    <h3>Par immatriculation</h3>
                    <p>Finalisez votre vente en ligne, nous venons récupérer votre véhicule chez vous</p>
                    <div class="features">
                        <div class="feature">Zéro erreur</div>
                        <div class="feature">Plus rapide</div>
                        <div class="feature">Données officielles</div>
                    </div>
                </div>
                
                <div class="divider">OU</div>
                
                <div class="card" onclick="showCaracteristiques()">
                    <span class="badge">PLUS PRÉCIS POUR VOUS</span>
                    <h3>Recherche manuelle</h3>
                    <p>Finalisez votre vente en ligne, nous venons récupérer votre véhicule chez vous</p>
                    <div class="features">
                        <div class="feature">Zéro erreur</div>
                        <div class="feature">Plus rapide</div>
                        <div class="feature">Données officielles</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section Recherche Immatriculation (HTML original conservé) -->
    <section class="progressive-section" id="immatriculation-section">
        <div class="main-section">
            <div class="container">
                <div class="header">
                    <h1 class="page-title">Recherche par immatriculation</h1>
                    <p class="page-subtitle">Saisissez votre plaque d'immatriculation pour une recherche automatique</p>
                </div>

                <div class="grid-container">
                    <div class="left-column">
                        <div class="search-row">
                            <!-- Removed input-check div that was causing green pin -->
                            <input type="text" class="immatriculation-input" id="immat-input" placeholder="AB123CD" maxlength="7" oninput="validateImmatFormat(this)">
                            <div class="error-message" id="immat-error" style="display: none;">Format attendu : AB123CD</div>
                        </div>
                        
                        <!-- Added kilometrage field below immatriculation -->
                        <div class="search-row" style="margin-top: 20px;">
                            <input type="number" class="immatriculation-input" id="km-input" placeholder="Kilométrage (ex: 50000)" min="0" max="500000" oninput="validateKmFormat(this)">
                            <div class="error-message" id="km-error" style="display: none;">Veuillez saisir un kilométrage valide</div>
                        </div>
                        
                        <!-- Updated button with disabled state and loading functionality -->
                        <button type="button" id="search-btn" class="search-button" disabled onclick="searchImmatriculation()">
                            <span id="search-text">Rechercher</span>
                        </button>
                        
                        <div class="format-info">
                            <div class="format-title">Format accepté</div>
                            <div class="format-text">Format : AB123CD (7 caractères sans tirets ni espaces)</div>
                        </div>
                    </div>

                    <!-- Updated result card with hidden state and validate button -->
                    <div class="result-card" id="result-card" style="display: none;">
                        <div style="display: flex; align-items: center; gap: 14px; margin-bottom: 28px;">
                            <div style="width: 36px; height: 36px; background: #4F46E5; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">✓</div>
                            <h2 style="font-size: 22px; font-weight: 700;">Véhicule trouvé !</h2>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 18px 40px; margin-bottom: 24px;">
                            <div><span style="font-weight: 600;">Marque:</span> Renault</div>
                            <div><span style="font-weight: 600;">Carburant:</span> Essence</div>
                            <div><span style="font-weight: 600;">Modèle:</span> Clio V</div>
                            <div><span style="font-weight: 600;">Puissance:</span> 90 ch</div>
                            <div><span style="font-weight: 600;">Année:</span> 2021</div>
                            <div><span style="font-weight: 600;">Couleur:</span> Blanc</div>
                        </div>

                        <div style="text-align: center; margin-bottom: 20px;">
                            <div style="background: #EBF4FF; border-radius: 20px; padding: 10px 20px; display: inline-block; color: #4F46E5; font-size: 13px; font-weight: 500;">
                                Les informations ont été récupérées via notre référentiel
                            </div>
                        </div>

                        <!-- Added validate button -->
                        <div style="text-align: center;">
                            <button class="validate-button" onclick="proceedToNextStep()" style="background: #4A40FF; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer;">
                                Valider
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Suppression et réécriture complète de la section caractéristiques du véhicule sans scroll automatique -->
    <section class="progressive-section" id="caracteristiques-section">
        <div class="caracteristiques-section">
            <div class="container">
                <div class="header">
                    <h1 class="section-title">Caractéristiques du véhicule</h1>
                    <p class="section-subtitle">Indiquez les caractéristiques de votre véhicule</p>
                </div>

                <div class="form-grid">
                    <!-- 1. Marque (dropdown obligatoire) -->
                    <div class="field-card" data-field="marque">
                        <select class="native-select" id="marque-select" onchange="updateFieldDisplay(this)">
                            <option value="">Sélectionnez la marque</option>
                            <option value="PEUGEOT">PEUGEOT</option>
                            <option value="RENAULT">RENAULT</option>
                            <option value="CITROËN">CITROËN</option>
                            <option value="BMW">BMW</option>
                            <option value="MERCEDES">MERCEDES</option>
                        </select>
                        <div class="field-label">MARQUE *</div>
                        <div class="field-value placeholder">Sélectionnez la marque</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 2. Modèle (dropdown obligatoire) -->
                    <div class="field-card" data-field="modele">
                        <select class="native-select" id="modele-select" onchange="updateFieldDisplay(this)">
                            <option value="">Sélectionnez le modèle</option>
                            <option value="208">208</option>
                            <option value="308">308</option>
                            <option value="3008">3008</option>
                            <option value="5008">5008</option>
                        </select>
                        <div class="field-label">MODÈLE *</div>
                        <div class="field-value placeholder">Sélectionnez le modèle</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 3. Année de 1ère immatriculation (dropdown obligatoire) -->
                    <div class="field-card" data-field="annee">
                        <select class="native-select" id="annee-select" onchange="updateFieldDisplay(this)">
                            <option value="">Année de 1e immatriculation</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                            <option value="2022">2022</option>
                            <option value="2021">2021</option>
                            <option value="2020">2020</option>
                        </select>
                        <div class="field-label">ANNÉE DE 1E IMMATRICULATION *</div>
                        <div class="field-value placeholder">Année de 1e immatriculation</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 4. Mois de 1ère immatriculation (dropdown obligatoire) -->
                    <div class="field-card" data-field="mois">
                        <select class="native-select" id="mois-select" onchange="updateFieldDisplay(this)">
                            <option value="">Mois de 1e immatriculation</option>
                            <option value="Janvier">Janvier</option>
                            <option value="Février">Février</option>
                            <option value="Mars">Mars</option>
                            <option value="Avril">Avril</option>
                            <option value="Mai">Mai</option>
                            <option value="Juin">Juin</option>
                            <option value="Juillet">Juillet</option>
                            <option value="Août">Août</option>
                            <option value="Septembre">Septembre</option>
                            <option value="Octobre">Octobre</option>
                            <option value="Novembre">Novembre</option>
                            <option value="Décembre">Décembre</option>
                        </select>
                        <div class="field-label">MOIS DE 1E IMMATRICULATION *</div>
                        <div class="field-value placeholder">Mois de 1e immatriculation</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 5. Carburant (dropdown) -->
                    <div class="field-card" data-field="carburant">
                        <select class="native-select" onchange="updateFieldDisplay(this)">
                            <option value="">Carburant</option>
                            <option value="Essence">Essence</option>
                            <option value="Diesel">Diesel</option>
                            <option value="Hybride">Hybride</option>
                            <option value="Électrique">Électrique</option>
                            <option value="GPL">GPL</option>
                        </select>
                        <div class="field-label">CARBURANT</div>
                        <div class="field-value placeholder">Carburant</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 6. Carrosserie (dropdown) -->
                    <div class="field-card" data-field="carrosserie">
                        <select class="native-select" onchange="updateFieldDisplay(this)">
                            <option value="">Carrosserie</option>
                            <option value="Berline">Berline</option>
                            <option value="Break">Break</Break>
                            <option value="SUV">SUV</option>
                            <option value="Coupé">Coupé</option>
                            <option value="Cabriolet">Cabriolet</option>
                            <option value="Monospace">Monospace</option>
                            <option value="Citadine">Citadine</option>
                        </select>
                        <div class="field-label">CARROSSERIE</div>
                        <div class="field-value placeholder">Carrosserie</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 7. Nombre de portes (dropdown) -->
                    <div class="field-card" data-field="portes">
                        <select class="native-select" onchange="updateFieldDisplay(this)">
                            <option value="">Nombre de portes</option>
                            <option value="3 portes">3 portes</option>
                            <option value="5 portes">5 portes</option>
                            <option value="4 portes">4 portes</option>
                            <option value="2 portes">2 portes</option>
                        </select>
                        <div class="field-label">NOMBRE DE PORTES</div>
                        <div class="field-value placeholder">Nombre de portes</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 8. Boîte de vitesses (dropdown) -->
                    <div class="field-card" data-field="boite-vitesses">
                        <select class="native-select" onchange="updateFieldDisplay(this)">
                            <option value="">Boîte de vitesses</option>
                            <option value="Manuelle">Manuelle</option>
                            <option value="Automatique">Automatique</option>
                            <option value="Robotisée">Robotisée</option>
                            <option value="CVT">CVT</option>
                        </select>
                        <div class="field-label">BOÎTE DE VITESSES</div>
                        <div class="field-value placeholder">Boîte de vitesses</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 9. Puissance fiscale (dropdown) -->
                    <div class="field-card" data-field="puissance-fiscale">
                        <select class="native-select" onchange="updateFieldDisplay(this)">
                            <option value="">Puissance fiscale</option>
                            <option value="4 CV">4 CV</option>
                            <option value="5 CV">5 CV</option>
                            <option value="6 CV">6 CV</option>
                            <option value="7 CV">7 CV</option>
                            <option value="8 CV">8 CV</option>
                            <option value="9 CV">9 CV</option>
                            <option value="10 CV">10 CV</option>
                        </select>
                        <div class="field-label">PUISSANCE FISCALE</div>
                        <div class="field-value placeholder">Puissance fiscale</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 10. Puissance moteur (dropdown) -->
                    <div class="field-card" data-field="puissance-moteur">
                        <select class="native-select" onchange="updateFieldDisplay(this)">
                            <option value="">Puissance moteur (Ch)</option>
                            <option value="75 Ch">75 Ch</option>
                            <option value="90 Ch">90 Ch</option>
                            <option value="110 Ch">110 Ch</option>
                            <option value="130 Ch">130 Ch</option>
                            <option value="150 Ch">150 Ch</option>
                            <option value="180 Ch">180 Ch</option>
                            <option value="Je ne sais pas">Je ne sais pas</option>
                        </select>
                        <div class="field-label">PUISSANCE MOTEUR (CH)</div>
                        <div class="field-value placeholder">Puissance moteur (Ch)</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 11. Couleur (dropdown) -->
                    <div class="field-card" data-field="couleur">
                        <select class="native-select" onchange="updateFieldDisplay(this)">
                            <option value="">Sélectionnez la couleur</option>
                            <option value="Blanc">Blanc</option>
                            <option value="Noir">Noir</option>
                            <option value="Gris">Gris</option>
                            <option value="Rouge">Rouge</option>
                            <option value="Bleu">Bleu</option>
                            <option value="Argent">Argent</option>
                            <option value="Autre">Autre</option>
                        </select>
                        <div class="field-label">COULEUR</div>
                        <div class="field-value placeholder">Sélectionnez la couleur</div>
                        <div class="chevron"></div>
                    </div>

                    <!-- 12. Kilométrage (input numérique obligatoire) -->
                    <div class="field-card" data-field="kilometrage">
                        <div class="field-label">KILOMÉTRAGE *</div>
                        <input type="number" class="field-input" id="kilometrage-input" placeholder="Précisez le kilométrage de la voiture" min="0" max="500000" />
                    </div>

                    <!-- 13. Version du véhicule (dropdown obligatoire) -->
                    <div class="field-card" data-field="version">
                        <select class="native-select" id="version-select" onchange="updateFieldDisplay(this)">
                            <option value="">Sélectionnez la version</option>
                            <option value="Active 1.2 PureTech 100">Active 1.2 PureTech 100</option>
                            <option value="Allure 1.2 PureTech 130">Allure 1.2 PureTech 130</option>
                            <option value="GT Line 1.2 PureTech 130">GT Line 1.2 PureTech 130</option>
                            <option value="GT 1.6 THP 205">GT 1.6 THP 205</option>
                            <option value="Style 1.0 VTi 68">Style 1.0 VTi 68</option>
                            <option value="Shine 1.2 PureTech 110">Shine 1.2 PureTech 110</option>
                            <option value="Crossway 1.2 PureTech 110">Crossway 1.2 PureTech 110</option>
                            <option value="Roland Garros 1.2 PureTech 100">Roland Garros 1.2 PureTech 100</option>
                            <option value="Signature 1.2 PureTech 130">Signature 1.2 PureTech 130</option>
                            <option value="Tech Edition 1.2 PureTech 100">Tech Edition 1.2 PureTech 100</option>
                        </select>
                        <div class="field-label">VERSION *</div>
                        <div class="field-value placeholder">Sélectionnez la version</div>
                        <div class="chevron"></div>
                    </div>
                </div>

                <!-- Réassurance sous le champ Version -->
                <div style="text-align: center; margin: 20px 0; font-size: 14px; color: #666;">
                    🔒 Toutes les versions sont vérifiées et officielles, vous pouvez choisir en toute confiance.
                </div>

                <div class="separator"></div>
                <!-- Ajout de la réassurance sur les données personnelles -->
                <div class="footer-info">
                    🔐 Vos informations sont strictement confidentielles et ne seront utilisées que pour vous recontacter dans le cadre de votre demande. • Données sécurisées • Aucun engagement
                </div>
            </div>
        </div>
    </section>

    <!-- Section État Général (HTML original conservé, cachée par défaut) -->
    <section class="progressive-section" id="etat-section">
        <div class="main-section">
            <div class="container">
                <div class="header">
                    <h1 class="section-title">État général du véhicule</h1>
                    <p class="section-subtitle">Évaluez l'état global de votre véhicule</p>
                </div>

                <div class="cards-row">
                    <!-- Added onclick events to make state cards clickable -->
                    <div class="state-card" data-state="excellent" data-impact="0" onclick="selectEtat(this)">
                        <svg class="star-icon" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        <h3 class="card-title">Excellent état</h3>
                        <p class="card-subtitle">Comme neuf</p>
                    </div>

                    <div class="state-card" data-state="tresBon" data-impact="-5" onclick="selectEtat(this)">
                        <svg class="star-icon" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        <h3 class="card-title">Très bon état</h3>
                        <p class="card-subtitle">Quelques rayures</p>
                    </div>

                    <div class="state-card" data-state="bon" data-impact="-10" onclick="selectEtat(this)">
                        <svg class="star-icon" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        <h3 class="card-title">Bon</h3>
                        <p class="card-subtitle">Usure normale</p>
                    </div>

                    <div class="state-card" data-state="correct" data-impact="-15" onclick="selectEtat(this)">
                        <svg class="star-icon" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        <h3 class="card-title">Correct</h3>
                        <p class="card-subtitle">Usure visible</p>
                    </div>

                    <div class="state-card" data-state="mauvais" data-impact="-25" onclick="selectEtat(this)">
                        <svg class="star-icon" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        <h3 class="card-title">Mauvais état</h3>
                        <p class="card-subtitle">Réparations importantes<br>à prévoir</p>
                    </div>
                </div>

                <div class="explanation-zone">
                    <h2 class="selected-state-title" id="state-title">-</h2>
                    <p class="selected-state-description" id="state-description">Sélectionnez un état</p>
                    <span class="impact-chip" id="impact-chip" style="display:none;">Impact sur le prix : -</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Section Options (HTML original conservé, cachée par défaut) -->
    <section class="progressive-section" id="options-equipements-section">
        <div class="container" style="padding: 40px 20px;">
            <div class="header">
                <h1 class="section-title">Options & équipements</h1>
                <p class="section-subtitle">Sélectionnez les équipements présents sur votre véhicule</p>
            </div>

            <div class="options-grid" id="optionsGrid">
                <!-- Options générées dynamiquement -->
            </div>

            <div class="info-section">
                <h3 style="font-size: 1.125rem; font-weight: 600; color: #1e3a8a; margin-bottom: 0.5rem;">Pourquoi ces informations ?</h3>
                <p style="color: #1e40af; line-height: 1.6;">Chaque équipement valorise votre véhicule sur le marché de l'occasion. Les options de sécurité et technologie sont particulièrement recherchées.</p>
            </div>
        </div>
    </section>

    <!-- Section Contact (HTML original conservé, cachée par défaut) -->
    <section class="progressive-section" id="contact-section">
        <div class="main-section">
            <div class="container">
                <!-- Adding new summary header block -->
                <div class="summary-block">
                    <div class="summary-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.22.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
                        </svg>
                    </div>
                    <div class="summary-content">
                        <div class="summary-main">
                            <div class="summary-label">Votre prix</div>
                            <div class="summary-price">XX XXX€</div>
                        </div>
                        <div class="summary-divider"></div>
                        <div class="summary-secondary">
                            <!-- Replacing reference with remaining steps -->
                            <div class="steps-accent"></div>
                            <div class="summary-secondary-text">2 étapes restantes pour débloquer</div>
                        </div>
                    </div>
                </div>

                <div class="header">
                    <h1 class="section-title">Vos informations personnelles</h1>
                    <p class="section-subtitle">Commençons par vous connaître</p>
                </div>

                <div class="form-grid">
                    <!-- Keeping only personal information fields in this section -->
                    <div class="field-card" data-field="nom">
                        <div class="field-label">NOM *</div>
                        <input type="text" class="field-input" placeholder="Votre nom" />
                    </div>

                    <div class="field-card" data-field="prenom">
                        <div class="field-label">PRÉNOM *</div>
                        <input type="text" class="field-input" placeholder="Votre prénom" />
                    </div>

                    <div class="field-card" data-field="email">
                        <div class="field-label">EMAIL *</div>
                        <input type="email" class="field-input" placeholder="votre.email@exemple.com" />
                    </div>

                    <div class="field-card" data-field="telephone">
                        <div class="field-label">TÉLÉPHONE *</div>
                        <input type="tel" class="field-input" placeholder="01 23 45 67 89" />
                    </div>
                </div>

                <!-- Adding separate section for project information -->
                <div class="project-section" style="margin-top: 50px;">
                    <h3 class="section-title" style="font-size: 32px; font-weight: 700; color: #1a1a1a; margin-bottom: 30px; text-align: center;">Informations sur votre projet</h3>
                    
                    <!-- Modified grid to support 3 columns and added vehicle type field -->
                    <div class="form-grid" style="grid-template-columns: repeat(3, 1fr); gap: 20px;">
                        <div class="field-card" data-field="projet">
                            <select class="native-select" id="projet-select">
                                <option value="">Choisir un modèle</option>
                                <option value="Modèle 1">Modèle 1</option>
                                <option value="Modèle 2">Modèle 2</option>
                                <option value="Modèle 3">Modèle 3</option>
                            </select>
                            <div class="field-label">PROJET D'ACHAT</div>
                            <div class="field-value placeholder">Choisir un modèle</div>
                            <div class="chevron"></div>
                        </div>

                        <div class="field-card" data-field="date">
                            <select class="native-select" id="date-select">
                                <option value="">Choisir un délai</option>
                                <option value="Dans 1 mois">Dans 1 mois</option>
                                <option value="Dans 3 mois">Dans 3 mois</option>
                                <option value="Dans 6 mois">Dans 6 mois</option>
                                <option value="Dans 1 an">Dans 1 an</option>
                            </select>
                            <div class="field-label">DATE PRÉVU DE L'ACHAT</div>
                            <div class="field-value placeholder">Choisir un délai</div>
                            <div class="chevron"></div>
                        </div>

                        <!-- Added new vehicle type dropdown -->
                        <div class="field-card" data-field="type-vehicule">
                            <select class="native-select" id="type-vehicule-select">
                                <option value="">Choisir un type</option>
                                <option value="Véhicule neuf">Véhicule neuf</option>
                                <option value="Véhicule d'occasion">Véhicule d'occasion</option>
                                <option value="Pas de projet d'achat">Pas de projet d'achat</option>
                            </select>
                            <div class="field-label">TYPE DE VÉHICULE</div>
                            <div class="field-value placeholder">Choisir un type</div>
                            <div class="chevron"></div>
                        </div>
                    </div>
                </div>

                <!-- Updated contact preferences HTML structure -->
                <div class="contact-preferences">
                    <h3 class="contact-preferences-title">Comment préférez-vous être contacté ?</h3>
                    <div class="contact-grid">
                        <div class="contact-card" data-contact="telephone">
                            <div class="contact-checkbox"></div>
                            <div class="contact-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                                </svg>
                            </div>
                            <div class="contact-info">
                                <div class="contact-title">Téléphone</div>
                                <div class="contact-subtitle">Appel direct</div>
                            </div>
                        </div>

                        <div class="contact-card" data-contact="email">
                            <div class="contact-checkbox"></div>
                            <div class="contact-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                                </svg>
                            </div>
                            <div class="contact-info">
                                <div class="contact-title">Email</div>
                                <div class="contact-subtitle">Courrier électronique</div>
                            </div>
                        </div>

                        <div class="contact-card" data-contact="sms">
                            <div class="contact-checkbox"></div>
                            <div class="contact-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
                                </svg>
                            </div>
                            <div class="contact-info">
                                <div class="contact-title">SMS</div>
                                <div class="contact-subtitle">Message texte</div>
                            </div>
                        </div>

                        <div class="contact-card" data-contact="whatsapp">
                            <div class="contact-checkbox"></div>
                            <div class="contact-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M17.05 12.05c-.3-.15-1.75-.85-2.02-.95-.27-.1-.47-.15-.67.15-.2.3-.77.95-.94 1.15-.17.2-.35.22-.64.07-.3-.15-1.26-.46-2.4-1.47-.88-.78-1.48-1.75-1.65-2.05-.17-.3-.02-.46.13-.61.13-.13.3-.35.45-.52.15-.17.2-.3.3-.5.1-.2.05-.37-.02-.52-.08-.15-.67-1.61-.92-2.21-.24-.58-.49-.5-.67-.51-.17-.01-.37-.01-.57-.01-.2 0-.52.07-.79.37-.27.3-1.04 1.02-1.04 2.48 0 1.46 1.07 2.87 1.22 3.07.15.2 2.11 3.22 5.11 4.52.71.31 1.27.49 1.7.63.71.23 1.36.2 1.87.12.57-.09 1.75-.72 2-.1.25-.69.25-1.29.17-1.41-.07-.12-.27-.2-.57-.35M12.04 2.04C6.5 2.04 2.04 6.5 2.04 12.04c0 1.75.46 3.5 1.32 5.02L2 22l5.07-1.33c1.48.81 3.15 1.24 4.97 1.24 5.54 0 10.04-4.5 10.04-10.04S17.58 2.04 12.04 2.04"/>
                                </svg>
                            </div>
                            <div class="contact-info">
                                <div class="contact-title">WhatsApp</div>
                                <div class="contact-subtitle">Message instantané</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Adding CTA button section -->
                <div class="cta-section">
                    <button class="cta-button" type="submit">Obtenez votre estimation</button>
                </div>

                <div class="footer-section">
                    <div class="footer-info">Données sécurisées • Aucun engagement</div>
                </div>
            </div>
        </div>
    </section>

    <script>
        let currentPath = null;

        // Gestion des options pour la section équipements
        const options = [
            { id: "1", name: "Climatisation", category: "Confort", categoryClass: "category-confort", selected: false },
            { id: "2", name: "GPS / Navigation", category: "Technologie", categoryClass: "category-technologie", selected: false },
            { id: "3", name: "Bluetooth / Mains libres", category: "Technologie", categoryClass: "category-technologie", selected: false },
            { id: "4", name: "Caméra de recul", category: "Sécurité", categoryClass: "category-securite", selected: false },
            { id: "5", name: "Régulateur de vitesse", category: "Confort", categoryClass: "category-confort", selected: false },
            { id: "6", name: "Sièges chauffants", category: "Confort", categoryClass: "category-confort", selected: false },
            { id: "7", name: "Jantes alliage", category: "Esthétique", categoryClass: "category-esthetique", selected: false },
            { id: "8", name: "Toit ouvrant", category: "Confort", categoryClass: "category-confort", selected: false },
            { id: "9", name: "Attelage", category: "Pratique", categoryClass: "category-pratique", selected: false }
        ];

        // Fonction pour afficher la section immatriculation
        function showImmatriculation() {
            currentPath = 'immatriculation';
            document.getElementById('caracteristiques-section').classList.remove('revealed');
            document.getElementById('immatriculation-section').classList.add('revealed');
            
            document.querySelectorAll('.options .card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            setTimeout(() => {
                document.getElementById('immatriculation-section').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        // Fonction pour afficher la section caractéristiques
        function showCaracteristiques() {
            currentPath = 'caracteristiques';
            document.getElementById('immatriculation-section').classList.remove('revealed');
            document.getElementById('caracteristiques-section').classList.add('revealed');
            
            document.querySelectorAll('.options .card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            setTimeout(() => {
                document.getElementById('caracteristiques-section').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        // Validation de l'immatriculation
        function validateImmatriculation() {
            const input = document.getElementById('immat-input');
            if (input.value.trim().length > 0) {
                document.getElementById('immat-check').classList.add('active');
                revealEtatSection();
            }
        }

        // Gestion de la saisie de l'immatriculation
        document.getElementById('immat-input')?.addEventListener('input', function() {
            if (this.value.trim().length > 0) {
                document.getElementById('immat-check').classList.add('active');
                revealEtatSection();
            } else {
                document.getElementById('immat-check').classList.remove('active');
                hideEtatSection();
            }
        });

        // Sélection des caractéristiques
        function selectCaracteristique(element) {
            element.classList.toggle('selected');
            checkCaracteristiquesValidation();
        }

        // Vérification de la validation des caractéristiques
        function checkCaracteristiquesValidation() {
            const selected = document.querySelectorAll('#caracteristiques-section .field-card.selected');
            if (selected.length >= 1) {
                revealEtatSection();
            } else {
                hideEtatSection();
            }
        }

        function revealEtatSection() {
            document.getElementById('etat-section').classList.add('revealed');
            // Removed automatic scrollIntoView to prevent unwanted scrolling
        }

        // Masquer la section État et les suivantes
        function hideEtatSection() {
            document.getElementById('etat-section').classList.remove('revealed');
            document.getElementById('options-equipements-section').classList.remove('revealed');
            document.getElementById('contact-section').classList.remove('revealed');
        }

        // Sélection de l'état
        function selectEtat(element) {
            document.querySelectorAll('.state-card').forEach(c => c.classList.remove('selected'));
            element.classList.add('selected');
            
            // Mise à jour de la zone d'explication
            const state = element.dataset.state;
            const stateDescriptions = {
                excellent: {
                    title: "Excellent état",
                    description: "Véhicule en parfait état, comme neuf",
                    impact: 0
                },
                tresBon: {
                    title: "Très bon état",
                    description: "Quelques traces d'usure mineures",
                    impact: -5
                },
                bon: {
                    title: "Bon",
                    description: "Usure normale correspondant à l'âge du véhicule",
                    impact: -10
                },
                correct: {
                    title: "Correct",
                    description: "Usure visible mais fonctionnement correct",
                    impact: -15
                },
                mauvais: {
                    title: "Mauvais état",
                    description: "Nombreux défauts, nécessite réparations",
                    impact: -25
                }
            };
            
            const stateInfo = stateDescriptions[state];
            document.getElementById('state-title').textContent = stateInfo.title;
            document.getElementById('state-description').textContent = stateInfo.description;
            
            const impactChip = document.getElementById('impact-chip');
            impactChip.style.display = 'inline-block';
            
            // Mettre à jour l'impact
            if (stateInfo.impact === 0) {
                impactChip.textContent = "Impact sur le prix : Aucun";
                impactChip.style.background = "#EBF4FF"; /* Remplacé le vert par du bleu */
                impactChip.style.color = "#4F46E5"; /* Remplacé le vert par du bleu */
            } else {
                impactChip.textContent = `Impact sur le prix : ${stateInfo.impact}%`;
                impactChip.style.background = "#D6DCFF";
                impactChip.style.color = "#4F46E5";
            }
            
            // Révéler la section Options
            renderOptions();
            revealOptionsEquipementsSection();
        }

        function revealOptionsEquipementsSection() {
            document.getElementById('options-equipements-section').classList.add('revealed');
            setTimeout(() => {
                // document.getElementById('options-equipements-section').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        // Fonction pour rendre les options
        function renderOptions() {
            const grid = document.getElementById('optionsGrid');
            grid.innerHTML = '';

            options.forEach(option => {
                const card = document.createElement('div');
                card.className = `option-card ${option.selected ? 'selected' : ''}`;
                card.onclick = () => toggleOption(option.id);

                card.innerHTML = `
                    <div class="card-header">
                        <span class="category-badge" style="background: ${getCategoryColor(option.category)}; color: ${getCategoryTextColor(option.category)};">
                            ${option.category}
                        </span>
                        <div class="checkbox ${option.selected ? 'checked' : ''}">
                            ${option.selected ? '<span style="color: white;">✓</span>' : ''}
                        </div>
                    </div>
                    <h3 class="option-name">${option.name}</h3>
                `;

                grid.appendChild(card);
            });
        }

        // Fonction pour basculer une option
        function toggleOption(id) {
            const option = options.find(opt => opt.id === id);
            if (option) {
                option.selected = !option.selected;
                renderOptions();
                checkOptionsValidation();
            }
        }

        // Vérification de la validation des options
        function checkOptionsValidation() {
            const selected = options.filter(opt => opt.selected);
            if (selected.length > 0) {
                document.getElementById('contact-section').classList.add('revealed');
                // Removed automatic scrollIntoView to prevent unwanted scrolling
            } else {
                document.getElementById('contact-section').classList.remove('revealed');
            }
        }

        // Helpers pour les couleurs des catégories
        function getCategoryColor(category) {
            const colors = {
                'Confort': '#dbeafe',
                'Technologie': '#e9d5ff',
                'Sécurité': '#d1fae5',
                'Esthétique': '#fed7aa',
                'Pratique': '#f3f4f6'
            };
            return colors[category] || '#f3f4f6';
        }

        function getCategoryTextColor(category) {
            const colors = {
                'Confort': '#1d4ed8',
                'Technologie': '#7c3aed',
                'Sécurité': '#059669',
                'Esthétique': '#ea580c',
                'Pratique': '#374151'
            };
            return colors[category] || '#374151';
        }

        // Gestion des inputs
        document.addEventListener('DOMContentLoaded', function() {
            // Gestion des inputs de texte
            document.querySelectorAll('.field-input').forEach(input => {
                input.addEventListener('input', function() {
                    const card = this.closest('.field-card');
                    if (this.value.trim()) {
                        card.classList.add('selected');
                        /* Removed validation-check creation - using chevron transformation instead */
                    } else {
                        card.classList.remove('selected');
                        /* Removed validation-check removal - no longer needed */
                    }
                });
            });

            // Gestion des selects natifs
            document.querySelectorAll('.native-select').forEach(select => {
                select.addEventListener('change', function() {
                    const card = this.closest('.field-card');
                    const valueElement = card.querySelector('.field-value');
                    
                    if (this.value) {
                        valueElement.textContent = this.value;
                        valueElement.classList.remove('placeholder');
                        card.classList.add('selected');
                        
                        /* Removed validation-check creation - using chevron transformation */
                    } else {
                        valueElement.textContent = this.options[0].text;
                        valueElement.classList.add('placeholder');
                        card.classList.remove('selected');
                        
                        /* Removed validation-check removal - no longer needed */
                    }
                });
            });

            // Adding clean contact option card handlers
            document.querySelectorAll('.contact-card').forEach(card => {
                card.addEventListener('click', function() {
                    this.classList.toggle('selected');
                });
            });
        });

function updateFieldDisplay(selectElement) {
    const fieldCard = selectElement.closest('.field-card');
    const fieldValue = fieldCard.querySelector('.field-value');
    
    if (selectElement.value) {
        fieldValue.textContent = selectElement.value;
        fieldValue.classList.remove('placeholder');
        fieldCard.classList.add('selected');
    } else {
        fieldValue.textContent = selectElement.querySelector('option[value=""]').textContent;
        fieldValue.classList.add('placeholder');
        fieldCard.classList.remove('selected');
    }
    
    checkCaracteristiquesCompletion();
}

function checkCaracteristiquesCompletion() {
    // Check required fields by their actual IDs
    const requiredFields = [
        'marque-select',
        'modele-select', 
        'annee-select',
        'mois-select',
        'kilometrage-input',
        'version-select'
    ];
    
    let allRequiredCompleted = true;
    
    requiredFields.forEach(fieldId => {
        const element = document.getElementById(fieldId);
        if (!element || !element.value || element.value === '') {
            allRequiredCompleted = false;
        }
    });
    
    if (allRequiredCompleted) {
        revealEtatSection();
        setTimeout(() => {
            const etatSection = document.getElementById('etat-section');
            if (etatSection) {
                etatSection.scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
            }
        }, 300);
    } else {
        hideEtatSection();
    }
}
        function validateImmatFormat(input) {
            // Sanitize input: remove spaces, hyphens, convert to uppercase
            let value = input.value.replace(/[\s-]/g, '').toUpperCase();
            input.value = value;
            
            const regex = /^[A-Z]{2}\d{3}[A-Z]{2}$/;
            const isValid = regex.test(value);
            const errorDiv = document.getElementById('immat-error');
            const searchBtn = document.getElementById('search-btn');
            
            if (value.length === 0) {
                // Empty input - reset state
                input.classList.remove('error', 'valid');
                errorDiv.style.display = 'none';
                searchBtn.disabled = true;
                searchBtn.setAttribute('aria-disabled', 'true');
                searchBtn.classList.remove('active');
            } else if (isValid) {
                // Valid format
                input.classList.remove('error');
                input.classList.add('valid');
                errorDiv.style.display = 'none';
                searchBtn.disabled = false;
                searchBtn.removeAttribute('aria-disabled');
                searchBtn.classList.add('active');
            } else {
                // Invalid format
                input.classList.add('error');
                input.classList.remove('valid');
                errorDiv.style.display = 'block';
                searchBtn.disabled = true;
                searchBtn.setAttribute('aria-disabled', 'true');
                searchBtn.classList.remove('active');
            }
        }

        function searchImmatriculation() {
            const searchBtn = document.getElementById('search-btn');
            const searchIcon = document.getElementById('search-icon');
            const searchText = document.getElementById('search-text');
            
            if (searchBtn.disabled) return;
            
            searchBtn.classList.add('loading');
            searchBtn.disabled = true;
            searchBtn.innerHTML = '<div class="spinner"></div><span>Recherche…</span>';
            
            // Simulate API call with random delay between 800-1200ms
            const delay = Math.random() * 400 + 800;
            
            setTimeout(() => {
                searchBtn.classList.remove('loading');
                searchBtn.disabled = false;
                searchBtn.innerHTML = '<span>Rechercher</span>';
                
                const resultCard = document.getElementById('result-card');
                resultCard.style.display = 'block';
                resultCard.style.opacity = '0';
                resultCard.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    resultCard.style.transition = 'all 0.3s ease';
                    resultCard.style.opacity = '1';
                    resultCard.style.transform = 'translateY(0)';
                }, 10);
                
            }, delay);
        }

        function proceedToNextStep() {
            // Scroll to next section (#etape-2 which is etat-section)
            const nextSection = document.getElementById('etat-section');
            if (nextSection) {
                nextSection.classList.add('revealed');
                setTimeout(() => {
                    nextSection.scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 100);
            }
        }
            function validateKmFormat(input) {
                const value = input.value;
                const kmError = document.getElementById('km-error');
                const isValid = value && !isNaN(value) && parseInt(value) >= 0 && parseInt(value) <= 500000;
                
                if (value && !isValid) {
                    input.style.borderColor = '#ff4444';
                    kmError.style.display = 'block';
                } else {
                    input.style.borderColor = isValid ? '#4F46E5' : '#ddd';
                    kmError.style.display = 'none';
                }
                
                updateSearchButtonState();
            }

            function validateImmatFormat(input) {
                let value = input.value.replace(/[\s-]/g, '').toUpperCase();
                input.value = value;
                
                const regex = /^[A-Z]{2}\d{3}[A-Z]{2}$/;
                const isValid = regex.test(value);
                const errorDiv = document.getElementById('immat-error');
                
                if (value && !isValid) {
                    input.style.borderColor = '#ff4444';
                    errorDiv.style.display = 'block';
                } else {
                    input.style.borderColor = isValid ? '#4F46E5' : '#ddd';
                    errorDiv.style.display = 'none';
                }
                
                updateSearchButtonState();
            }

            function updateSearchButtonState() {
                const immatInput = document.getElementById('immat-input');
                const kmInput = document.getElementById('km-input');
                const searchBtn = document.getElementById('search-btn');
                
                const immatValid = /^[A-Z]{2}\d{3}[A-Z]{2}$/.test(immatInput.value);
                const kmValid = kmInput.value && !isNaN(kmInput.value) && parseInt(kmInput.value) >= 0 && parseInt(kmInput.value) <= 500000;
                
                if (immatValid && kmValid) {
                    searchBtn.disabled = false;
                    searchBtn.style.background = '#4A40FF';
                    searchBtn.style.cursor = 'pointer';
                } else {
                    searchBtn.disabled = true;
                    searchBtn.style.background = '#ccc';
                    searchBtn.style.cursor = 'not-allowed';
                }
            }
        
        document.getElementById('type-vehicule-select').addEventListener('change', function() {
            const card = this.closest('.field-card');
            const valueDisplay = card.querySelector('.field-value');
            const chevron = card.querySelector('.chevron');
            
            if (this.value) {
                valueDisplay.textContent = this.value;
                valueDisplay.classList.remove('placeholder');
                card.classList.add('selected');
                
                // Replace chevron with checkmark
                chevron.innerHTML = '<svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M16.25 6.25L8.125 14.375L3.75 10" stroke="#4F46E5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                chevron.style.backgroundColor = '#4F46E5';
                chevron.style.borderRadius = '50%';
                chevron.style.padding = '2px';
            } else {
                valueDisplay.textContent = 'Choisir un type';
                valueDisplay.classList.add('placeholder');
                card.classList.remove('selected');
                
                // Restore chevron
                chevron.innerHTML = '';
                chevron.style.backgroundColor = '';
                chevron.style.borderRadius = '';
                chevron.style.padding = '';
            }
        });
    </script>
</body>
</html>
